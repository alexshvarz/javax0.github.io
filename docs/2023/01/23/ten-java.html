<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ten Useless Things You Did Not Know About Java | Java Deep, mostly Java</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Ten Useless Things You Did Not Know About Java" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam" />
<meta property="og:description" content="Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam" />
<link rel="canonical" href="https://javax0.github.io/2023/01/23/ten-java.html" />
<meta property="og:url" content="https://javax0.github.io/2023/01/23/ten-java.html" />
<meta property="og:site_name" content="Java Deep, mostly Java" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-01-23T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ten Useless Things You Did Not Know About Java" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-23T00:00:00+01:00","datePublished":"2023-01-23T00:00:00+01:00","description":"Article Management Technical Details Code https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java Article source https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam","headline":"Ten Useless Things You Did Not Know About Java","mainEntityOfPage":{"@type":"WebPage","@id":"https://javax0.github.io/2023/01/23/ten-java.html"},"url":"https://javax0.github.io/2023/01/23/ten-java.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://javax0.github.io/feed.xml" title="Java Deep, mostly Java" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Java Deep, mostly Java</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/">Java Deep</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ten Useless Things You Did Not Know About Java</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-01-23T00:00:00+01:00" itemprop="datePublished">Jan 23, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <details>
<summary class="title">Article Management Technical Details</summary>
<div class="content">
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Code <a href="https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java">https://github.com/javax0/javax0.github.io/tree/master/_projects/2023-01-23-ten-java</a></p>
</li>
<li>
<p>Article source <a href="https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam">https://github.com/javax0/javax0.github.io/blob/master/_posts/2023-01-23-ten-java.adoc.jam</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>Java is a complex language, and some features that initially seemed a good idea turned out to be useless.
In this article, we will look at ten such Java language features.</p>
</div>
<div class="sect1">
<h2 id="1-java-has-labels">1. Java Has Labels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can have labels in your Java code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1.         LABEL1:
 2.         for (int i = 0; i &lt; 10; i++) {
 3.             for (int j = 0; j &lt; 10; j++) {
 4.                 if (i * j &gt; 15 &amp;&amp; (i * j) % 2 == 0) break LABEL1;
 5.                 System.out.print("%d,%d ".formatted(i, j));
 6.             }
 7.             System.out.println();
 8.         }
 9.         System.out.println();
10.         System.out.println();
11.         LABEL2:
12.         for (int i = 0; i &lt; 10; i++) {
13.             for (int j = 0; j &lt; 10; j++) {
14.                 if (i * j &gt; 15 &amp;&amp; (i * j) % 2 == 0) {
15.                     System.out.println();
16.                     continue LABEL2;
17.                 }
18.                 System.out.print("%d,%d ".formatted(i, j));
19.             }
20.             System.out.println();
21.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like you could have them in assembly.
Or when you were programming BASIC numbering the lines.</p>
</div>
<div class="paragraph">
<p>To interrupt an outer loop, you can reference these labels in the <code>break</code> or <code>continue</code> command.</p>
</div>
<div class="paragraph">
<p>The output of the above program is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7

0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7
3,0 3,1 3,2 3,3 3,4 3,5
4,0 4,1 4,2 4,3
5,0 5,1 5,2 5,3
6,0 6,1 6,2
7,0 7,1 7,2 7,3
8,0 8,1
9,0 9,1</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to compare, here is the version without the labels:</p>
</div>
<details>
<summary class="title">Click to open the version without labels</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1.         for (int i = 0; i &lt; 10; i++) {
 2.             for (int j = 0; j &lt; 10; j++) {
 3.                 if (i * j &gt; 15 &amp;&amp; (i * j) % 2 == 0) break;
 4.                 System.out.print("%d,%d ".formatted(i, j));
 5.             }
 6.             System.out.println();
 7.         }
 8.         System.out.println();
 9.         System.out.println();
10.         for (int i = 0; i &lt; 10; i++) {
11.             for (int j = 0; j &lt; 10; j++) {
12.                 if (i * j &gt; 15 &amp;&amp; (i * j) % 2 == 0) {
13.                     System.out.println();
14.                     continue;
15.                 }
16.                 System.out.print("%d,%d ".formatted(i, j));
17.             }
18.             System.out.println();
19.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7
3,0 3,1 3,2 3,3 3,4 3,5
4,0 4,1 4,2 4,3
5,0 5,1 5,2 5,3
6,0 6,1 6,2
7,0 7,1 7,2 7,3
8,0 8,1
9,0 9,1


0,0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9
1,0 1,1 1,2 1,3 1,4 1,5 1,6 1,7 1,8 1,9
2,0 2,1 2,2 2,3 2,4 2,5 2,6 2,7


3,0 3,1 3,2 3,3 3,4 3,5
3,7
3,9
4,0 4,1 4,2 4,3






5,0 5,1 5,2 5,3
5,5
5,7
5,9
6,0 6,1 6,2







7,0 7,1 7,2 7,3
7,5
7,7
7,9
8,0 8,1








9,0 9,1
9,3
9,5
9,7
9,9</code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="2-you-can-break-from-a-block">2. You can <code>break</code> from a Block</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Labels make it possible to break from a block.
It does not need to be a loop.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1.         for (int i = 1; i &lt;= 15; i++) {
 2.             FIZZ:
 3.             {
 4.                 System.out.printf("%d ", i);
 5.                 if (i % 3 != 0) break FIZZ;
 6.                 System.out.print("fiz");
 7.             }
 8.             BUZZ:
 9.             {
10.                 if (i % 5 != 0) break BUZZ;
11.                 System.out.print("buzz");
12.             }
13.             System.out.println();
14.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>It will print</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">1
2
3 fiz
4
5 buzz
6 fiz
7
8
9 fiz
10 buzz
11
12 fiz
13
14
15 fizbuzz</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="3-static-methods-can-also-be-final">3. <code>static</code> Methods can also be <code>final</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When a method is final in a class, you cannot redefine it in a child class.
Static methods, however, are not virtual.
They cannot be redefined.
A static method in the child class of the same signature has nothing to do with the method in the parent class.
Or does it?</p>
</div>
<div class="paragraph">
<p>Actually, it does.
If the static method is <code>final</code>, then the child class cannot have a method with the same signature.</p>
</div>
<div class="paragraph">
<p>To demonstrate this, we compile the test classes dynamically.
We do not want any syntax errors in our demo project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1.         final var FIZZ = """
 2.                 package com.javax0.blog.tenjava;
 3.                 public class Fizz {
 4.                     static void fizzy(){
 5.                     }
 6.                 }
 7.                 """;
 8.         final var BUZZ = """
 9.                 package com.javax0.blog.tenjava;
10.                 public class Buzz extends Fizz {
11.                     static void fizzy(){
12.                     }
13.                 }
14.                 """;
15.         final var testSet1 = Compiler.java().from(
16.                 FIZZ
17.         ).from(BUZZ).compile().load();
18.         testSet1.get("Buzz");
19.         Assertions.assertThrows(Compiler.CompileException.class, () -&gt; Compiler.java().from(
20.                 FIZZ.replaceAll("static void", "final static void")
21.         ).from(BUZZ).compile());</code></pre>
</div>
</div>
<div class="paragraph">
<p>We compile FIZZ and BUZZ.
Both classes have a method named <code>fizzy()</code>.
No problem.
Then we change the method in the class <code>Fizz</code> to <code>final</code>.
Now the compilation fails.</p>
</div>
<div class="paragraph">
<p>You cannot "override" the final method.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="4-goto-is-a-reserved-word">4. <code>goto</code> is a reserved word</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is no <code>goto</code> in Java; still, ' goto` is a keyword.
The designers of the language thought it to be a good idea.
Future versions of Java may have a <code>goto</code> statement.
Let&#8217;s reserve this as a keyword.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1.         Compiler.java().from("""
 2.                 package com.javax0.blog.tenjava;
 3.                 class NoGotoPlease{
 4.                   public void _goto(){
 5.                   }
 6.                 }
 7.                 """
 8.         ).compile();
 9.         Assertions.assertThrows(Compiler.CompileException.class, () -&gt; Compiler.java().from("""
10.                 package com.javax0.blog.tenjava;
11.                 class NoGotoPlease{
12.                   public void goto(){
13.                   }
14.                 }
15.                 """
16.         ).compile());</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we name the method <code>_goto</code>, it is okay.
Using it without an underscore in the front: it is a keyword.
It does not compile.</p>
</div>
<div class="paragraph">
<p>If you consider that <code>var</code>, on the other hand, is NOT a keyword&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="5-var-is-not-a-keyword-in-java">5. <code>var</code> is not a keyword in Java</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java 10  introduced <code>var</code>.
There are a lot of articles about how you can use <code>var</code> and why <code>var</code> is not syntactic sugar.
However, <code>var</code> is also not a keyword.</p>
</div>
<div class="paragraph">
<p>If it was a keyword, we could have a program, like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> 1. public class VarNotKeyword {
 2.     final int var = 13;
 3.
 4.     void myMethod() {
 5.         int var = var().var;
 6.     }
 7.
 8.     VarNotKeyword var() {
 9.         return new VarNotKeyword();
10.     }
11.
12. }</code></pre>
</div>
</div>
<div class="paragraph">
<p>which was a valid code before Java 10.
It still is because <code>var</code> is not a keyword, but it would be ruined if it was.
Luckily, it is not.</p>
</div>
<div class="paragraph">
<p>You cannot name a class to be <code>var</code>.
This means that even though <code>var</code> is not a keyword, we may still have some incompatibility.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="6-stream-operations-are-mutating">6. Stream operations are mutating</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is also a Java secret, but at least this knowledge is not useless.
After all, who would like to read an article full of useless things?
As a matter of fact, there was a question on a Java interview, so it may even be essential to know.</p>
</div>
<div class="paragraph">
<p>When you chain the stream methods, they transform streams.
There is no operation happening until the final terminal operation is chained up and starts to execute.
The stream operations without the terminal operation only build up the operation chain.
They transform one stream into a new stream.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Not only!</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Stream operations, like <code>map</code>, also modify the stream they are attached to.
The stream will remember that an operation was already attached to it and will throw an exception if you try to form a stream.
The following code demonstrates this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final Stream&lt;Object&gt; stream = Stream.of("a", 2, 3, new Object[2]);
2.         final var stringStream1 = stream.map(Object::toString);
3.         try {
4.             final var stream2 = stream.map(obj -&gt; " " + obj);
5.         } catch (IllegalStateException e) {
6.             System.out.println(e);
7.         }
8.         final var string = stringStream1.collect(Collectors.joining("\n"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output of this is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">java.lang.IllegalStateException: stream has already been operated upon or closed</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="7-streams-do-not-always-run">7. Streams do not always run</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You know that the intermediary operations on a stream do not run if there is no terminal operation.
The terminal operation is the one that runs the streams invoking all the intermediary ones for the elements.
However, not all terminal operations run the whole chain.
It may lead to surprises in some cases.
To see that, let&#8217;s use <code>peek()</code>.</p>
</div>
<div class="paragraph">
<p><code>peek()</code> is a stream intermediary method that does not modify the stream.
The Javadoc of the method in the official JDK documentation says:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>This method exists mainly to support debugging, where you want to see the elements as they flow past a certain point in a pipeline.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The same Javadoc then gives a sample that uses <code>System.out.println</code> to print values from a stream in different stages.
We will do the same</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final var w = Stream.of(1, 2, 3, 4, 5, "apple", "bird", 3.1415926)
2.                 .peek(System.out::println).toArray();
3.         System.out.println(w.length);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This sample goes through the elements of the stream.
It prints the elements of the stream and then the number of the elements as we have collected them to an <code>Object[]</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">1
2
3
4
5
apple
bird
3.1415926
8</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is nice and dandy.
What if we do not collect the elements?
In the example above, we are only interested in the number of elements; there is no reason to collect them into an array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final long z = Stream.of(1, 2, 3, 4, 5, "apple", "bird", 3.1415926)
2.                 .peek(System.out::println).count();
3.         System.out.println(z);</code></pre>
</div>
</div>
<div class="paragraph">
<p>We expect to get the same output as before.
The reality, however, is that the output this time is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">8</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where did the elements go?
Why <code>peek</code> does not print the elements?</p>
</div>
<div class="paragraph">
<p>In this case, the terminal operation <code>count()</code> does not execute the stream pipeline.
Therefore, the <code>peek()</code> action is not invoked.
There is no magic or secret in it.
The JavaDoc of <code>count()</code> explains it.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>An implementation may choose to not execute the stream pipeline &#8230;&#8203; if it is capable of computing the count directly from the stream source.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>In some cases, like the one in the example above, the terminal operation <code>count()</code> does not need to iterate through the stream to know the number of elements.
So it does not.</p>
</div>
<div class="paragraph">
<p>Even the documentation of <code>peek()</code> has a link to this fact.
Nobody reads documentation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="8-strictfp-is-a-modifier">8. <code>strictfp</code> is a modifier</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once upon a time, there was a keyword called <code>strictfp</code>.
It was introduced in Java 1.2 and required the floating point calculations to be performed differently.
Floating point calculations traditionally used the format IEEE 754 standard defined.
The early x86 processors with the x87 floating point coprocessor worked differently.
The coprocessor used a longer format, allowing more precision.
The <code>float</code> and <code>double</code> values were 64bit, but the generated code stored the intermediate values on more bits during a calculation.</p>
</div>
<div class="paragraph">
<p>Before Java 1.2, the compiler generated machine code modifying the result of every intermediate value to 64bit.
This required extra machine code operations and slowed the calculation down.
It was not only slower but more error-prone to overflow errors.
A calculation result could be okay with the 64-bit precision while some intermediate values overflowed.
Using more precision provided by the hardware could lead to the correct value.</p>
</div>
<div class="paragraph">
<p><code>strictfp</code> was introduced to let the compiler generate a more effective floating-point code.
With 1.2 and later till Java 17, the compiler generates code using the extra precision unless the class or method is <code>strictfp</code>.</p>
</div>
<div class="quoteblock">
<div class="title">just kidding</div>
<blockquote>
<div class="paragraph">
<p><code>strictfp</code> means that the floating calculation will result in the exact wrong result on all platforms.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Times change.
Pentium 4 in 2001 allows the compiler to avoid the extra code for strict floating point.
Java could generate the strict floating point effectively.</p>
</div>
<div class="paragraph">
<p>Java 17 came 20 years later, and Java changed again.
Java 17 later uses strict arithmetic even when <code>strictfp</code> is not specified.</p>
</div>
<div class="paragraph">
<p>You can still use it, and reflectively query its existence on a class, interface, or non-abstract method, but the Java compiler does not use it anymore.
Maybe, the Java compiler was the only one using <code>strictfp</code> even in the past.
At least, I have never met anyone who needed that and used it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="9-there-are-multiple-arraylist-implementations-in-the-jdk">9. There are multiple <code>ArrayList</code> implementations in the JDK</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have programmed Java for a long time, you know that you can easily create a list of elements calling <code>Array.asList()</code>.
If you look at the implementation of this static method, you can see that it is simply:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @SafeVarargs
    @SuppressWarnings("varargs")
    public static &lt;T&gt; List&lt;T&gt; asList(T... a) {
        return new ArrayList&lt;&gt;(a);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>in the class <code>java.util.Arrays</code>.
Although the method&#8217;s return type is the interface <code>List</code>, the documentation guarantees that the return type is <code>ArrayList</code>.
It says</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Returns a fixed-size list backed by the specified array.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>So it is an <code>ArrayList</code>.
Yes and no.
Let&#8217;s try the following program:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         try {
2.             final ArrayList&lt;Integer&gt; x = (ArrayList) Arrays.asList(1, 2, 3, 4);
3.         } catch (ClassCastException cce) {
4.             System.out.println(cce);
5.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">java.lang.ClassCastException: class java.util.Arrays$ArrayList cannot be cast to class java.util.ArrayList (java.util.Arrays$ArrayList and java.util.ArrayList are in module java.base of loader 'bootstrap')</code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned list is an <code>ArrayList</code>, but it is a <code>java.util.Arrays$ArrayList</code> and not <code>java.util.ArrayList</code>.
These are two different classes and are not compatible.
One cannot be converted to the other; only the simple name is the same.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Two classes are the same if their <em>canonical name</em> is the same and were loaded by one class loader.
The simple name being the same is not enough.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Why did the implementors of <code>asList()</code> create a new <code>ArrayList</code> class?
Probably they wanted to create optimized code.
The list this method returns is backed up by an array just like the <code>java.util</code> one.
However, this array cannot be resized.
It is the same array that you provided as an argument.
It is not copied or cloned.
It remains in its place and is used by the list implementation.
You can see that in the following code sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final Integer[] w = {1, 2, 3};
2.         final var wl = Arrays.asList(w);
3.         Assertions.assertEquals(1, wl.get(0));
4.         w[0] = 55;
5.         wl.set(1, 66);
6.         Assertions.assertEquals(55, wl.get(0));
7.         Assertions.assertEquals(66, w[1]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the code modifies the array, the list also gets modified.
When the list is modified, the array also gets modified.
That is because they are one and the same.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="10-something-something">10. something != something</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recently a friend (Istvan Kovács) posted a puzzle on <a href="https://www.linkedin.com/feed/update/urn:li:activity:7022233914991640576/">Linked-in</a>.
What should you write to the place of <code>???</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final var variable = ???;
2.         if( variable == variable ){
3.             Assertions.fail("variable is == to variable");
4.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The question was: what should you write into the place of the <code>???</code> characters?
Unless you want to have a failing test, you need something which is not equal to itself.</p>
</div>
<div class="paragraph">
<p>It cannot be an object, because <code>==</code> compares the reference "address", therefore an object is always <code>==</code> to itself.
It can only be a primitive value.</p>
</div>
<div class="paragraph">
<p>The solution comes from the <a href="https://ieeexplore.ieee.org/document/30711">IEEE 754</a> standard.
It has the sentence:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The exceptions are C predicates “ x == x ” and “ x != x ”, which are respectively 1 and 0 for every
infinite or finite number x but reverse if x is Not a Number ( NaN )</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Although it talks about the C language, Java has inherited a lot from it.
Java implements the standard as we have already discussed related to the <code>strictfp</code> keyword.
That way the code sample is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final var variable = Float.NaN;
2.         if( variable == variable ){
3.             Assertions.fail("variable is == to variable");
4.         }</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">1.         final var variable = Double.NaN;
2.         if( variable == variable ){
3.             Assertions.fail("variable is == to variable");
4.         }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="11-summary">11. Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have visited ten Java features.
These are not important.
Writing about these was fun, and I hope reading them was also fun.
I tried to be precise, and I could not resist including some information that may also be useful despite the article title.</p>
</div>
<div class="paragraph">
<p>If you know any other more or less useless facts about Java, please write them down in the comments.</p>
</div>
</div>
</div>


<!-- Disqus comments section goes here (if comments are enabled) -->

<hr/>
<h1>Comments</h1>
<p>Please leave your comments using Disqus, or just press one of the happy faces.
If for any reason you do not want to leave a comment here, <a href="https://github.com/javax0/javax0.github.io/issues">you can still create a Github ticket</a>.</p>
<div class="comments">
    <div id="disqus_thread"></div>

    <script type="text/javascript">

        /* * * STOP! * * */
        /* You shouldn't need to edit ANYTHING below to get this working! */
        /* Instead, edit the key `disqus.shortname` in _config.yml */

        var disqus_config = function (){
            this.page.url = 'https://javax0.github.io/2023/01/23/ten-java.html';
            this.page.identifier = '/2023/01/23/ten-java.html';
        };

        (function() {
            var d = document, s = d.createElement('script');
            s.type = 'text/javascript'; s.async = true;
            s.src = 'https://javax0.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();

    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>




  </div><a class="u-url" href="/2023/01/23/ten-java.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Java Deep, mostly Java</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Java Deep, mostly Java</li><li><a class="u-email" href="mailto:peter@verhas.com">peter@verhas.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/verhas"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">verhas</span></a></li><li><a href="https://www.twitter.com/verhas"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">verhas</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>javax0 is a technical Java oriented blog. Whenever I find something interesting, in the mood and feel the power to publish it, you will get it here. Publications are usually released on Wednesday 15:00am GMT. Earlier posts of the blog were published on Javax0 Wordpress Site at https://javax0.wordpress.com</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
